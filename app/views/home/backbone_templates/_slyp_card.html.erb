<script type="text/template" id="js-slyp-card-tmpl">

  <div class="extra content" >
    <div class="right floated">{ model:total_reslyps | numReslyps }</div>
    <div class="left floated">
      { model:duration | consumption model:slyp_type }
    </div>
  </div>

  <div class="blurring dimmable image">
    <div class="ui dimmer">
      <div class="content">
        <div class="center">
          <div rv-show="model:html" id="preview-button" class="ui primary icon button"><i class="ui search icon"></i>Preview</div>
          <a rv-hide="model:html" target="_blank" rv-href="model:url" class="ui primary icon button">Go there<i class="ui right arrow icon"></i></a>
        </div>
      </div>
    </div>
    <a rv-href="model:url" target="_blank">
      <img type="image" class="ui small image display centered" rv-data-src="model:display_url" src="/assets/blank-image.png">
    </a>
  </div>

  <div class="content">
    <a class="header center aligned wrap" target="_blank" rv-href="model:url">{ model.displayTitle | trunc }</a>
    <div class="meta center aligned">
      <a target="_blank" rv-href="model:url">
        <span>{ model:author | authorship model:site_name model:url }</span>
      </a>
    </div>
  </div>

  <div class="ui hidden divider"></div>
  <div class="extra content friend-data">
    <div class="content">
      <i id="favorite-action" class="right floated star icon" rv-class-active="model:favourite" data-content="favorite" data-variation="tiny"></i>
      <i id="archive-action" class="right floated archive icon" rv-class-active="model:archived" data-content="archive" data-variation="tiny"></i>
      <a class="summary front-display" >
        <i class="comment icon"></i>
        <span>{ model:reslyps | numComments }</span>
      </a>
      <div class="ui fluid popup friend-comments">
        <div class="ui comments">
          <div class="comment" rv-each-reslyp="model:reslyps">
            <div class="avatar" rv-data-title="reslyp.sender.email">
              <img class="round" rv-avatar="reslyp.sender.first_name | fallback reslyp.sender.email">
            </div>
            <div class="content">
              <a class="author">{ reslyp.sender.first_name } { reslyp.sender.last_name }</a>
              <div class="metadata">
                <span class="date">{ reslyp.created_at | fromNow }</span>
              </div>
              <div class="text">
                <p>{ reslyp.comment }</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <span id="friends" class="description">
        <b>from</b>
        <i class="user icon"></i>
        <span>{ model:friends | numFriends }</span>
      </span>
      <div class="ui fluid popup">
        <div class="ui comments">
          <div class="comment" rv-each-friend="model:friends">
            <div class="avatar" rv-data-title="friend.email">
              <img class="round" rv-avatar="friend.first_name | fallback friend.email">
            </div>
            <div class="content">
              <div class="author">{ friend.first_name | userDisplay friend.last_name friend.email }</div>
              <div class="text">{ friend.sender | slypDirection }</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div rv-fade-show="state.gotAttention" class="ui fluid mobile show" style="display: none;">
    <div class="ui fluid multiple selection search dropdown labeled icon button" rv-data-user-slyp-id="model:id">
      <i class="add user icon"></i>
      <div class="default text">send to friends</div>
      <input id="recipient-emails" type="hidden" name="reslyps">
      <div class="menu"></div>
    </div>
    <div class="ui action input fluid" rv-show="state.canReslyp">
      <input id="reslyp-comment" type="text" name="comment" placeholder="add a comment"  rv-value="state.comment">
      <button class="ui positive button" rv-class-loading="state.reslyping" rv-class-unless-disabled="state.hasComment < comment"><i class="send icon"></i>Send</button>
    </div>
  </div>

  <div class="ui long modal" target="_blank" rv-href="model:url" rv-data-user-slyp-id="model:id">
    <i class="close icon"></i>
    <span class="ui header center aligned wrap">{ model.displayTitle }</span>
    <div class="ui basic center aligned segment">
      <a target="_blank" rv-href="model:url" style="color: #b1b2b2; font-size: 1.33rem;" >
        <span>{ model:author | authorship model:site_name model:url}</span>
      </a>
    </div>
    <div class="ui center aligned basic segment" rv-html="model:html">
    </div>
  </div>
</script>